<!DOCTYPE html>
<html>
<head>
    <title>
        TOPedu    
    </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="design/index.css" rel="stylesheet">
</head>
<body>
    <div class='wrap'>
        <div class='middle'>
        </div> 
    </div>

    <div class='error'>
        <h2>지원하지 않는 화면 크기입니다.</h2>
    </div>
    <script type="text/javascript" src="level.js"></script>
    <script src="//code.jquery.com/jquery.min.js"></script>
    <script>
        var list = document.getElementById('list');
        var cont='<img src="design/logo_red_name.png" style="width: 50%;" alt="logo">\
            <div class="list" id ="list">';
        for(var i=0; i < level.length; i++){
            cont += "<button class='lv_btn' onclick=move('"+i+"') >"+level[i]+"</button>";
        }
        cont += '</div>';

        var index;
        var level_name;
        var mp3_list;
        $('.middle').html(cont);
        $(".middle").hide();
        $(".middle").fadeIn(2000);
        
        function move(i){
            level_name=level[i];
            index = i;
            mp3_list = Object.keys(file_url[level[i]]);
            var res=level[i]+
                    "<p onclick='window.location.reload()'><u>뒤로가기</u></p>\
                    <div class='list' id ='list'>";
            for(var j=0; j<mp3_list.length; j++){
                res += "<button class='btn3' style='widith' onclick='move_mp3(\""+j+"\")'>"+mp3_list[j]+"</button><br>";
            }
            res+="</div>"
            $('.middle').html(res);
            $(".middle").hide();
            $(".middle").fadeIn(1000);
        }

        function move_mp3(unit_num){
            var unit = mp3_list[unit_num];
            var files = file_url[level_name][unit];
            var res="<p>"+unit+"</p>\
                <p onclick='move("+index+")'><u>뒤로가기</u></p>";
            for(var j=0; j<files.length; j++){
                res += "<audio id='audio' onended='done()'>\
                <source src='https://docs.google.com/uc?export=open&id="+files[j]+"'>\
                </audio>";
            }
            res+="<button class='btn2' onclick='start()'>START</button>\
            <button class='btn2' onclick='back()'>-10초</button>\
            <button class='btn2' onclick='stop()'>STOP</button>";
            $('.middle').html(res);
            $(".middle").hide();
            $(".middle").fadeIn(1000);
        }
        function start(){
            document.getElementById('audio').play();
        }
        function stop(){
            document.getElementById('audio').pause();
        }
        function back(){
            var temp = document.getElementById('audio').currentTime;
            temp-=10;
            document.getElementById('audio').currentTime = temp;
        }
        function done(){
            var result = confirm("확인버튼을 누르세요.");
            if(result){
                $.ajax({
                url: "done_check.php",
                data:"",
            }).done(function(data) {
                alert("숙제를 완료하였습니다.");
            });
            }
        }
    </script>
</body>
</html>
