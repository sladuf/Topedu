<!DOCTYPE html>
<html>
<head>
    <title>
        TOPedu    
    </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="../design/index.css" rel="stylesheet">
    <?
    include '../session.php';
    ?>
</head>
<body>
    <div class='wrap'>    
        <div class='middle'>
            <img src="../design/logo_red_name.png" style="width: 100%;" alt='logo'>
            <h2 style="color: #E6061F;"><? echo $name; ?></h2>
            <select id='list' class ='select_level'>
            </select><br>
            <button class='btn' onclick="search()">검색</button>
        </div>
    </div>
    <script type="text/javascript" src="../level.js"></script>
    <script>
        var list = document.getElementById('list');
            var cont="<option value=''>level</option>";
            for(var i=0; i < level.length; i++){
                cont += "<option value='"+level[i]+"'>"+level[i]+"</option>";
            }
            list.innerHTML=cont;
    </script>
    <script src="//code.jquery.com/jquery.min.js"></script>
    <script>
        function search() {
            $.ajax({
                url: "search.php",
                type: "get",
                data: {
                    st_level : $('#list').val(),
                }
            }).done(function(data) {
                const result = jQuery.parseJSON(data);
                var res="<p onclick='window.location.reload()'><u>뒤로가기</u></p>";
                for(var i=0; i<result.length; i++){
                    res += "<div>"+result[i].name + 
                    "&nbsp;&nbsp;<button class='btn2' onclick='modify(\""+result[i].id+"\","+i+")'>수정</button>\
                    <button class='btn2' onclick='del(\""+result[i].id+"\")'>삭제</button></div>\
                    <div id="+i+"></div>";
                }

                $('.middle').html(res);
            });
        }
        function modify(st_id,i){

                var temp= "#"+i;
                var res = "<select name='st_level' id='list' class ='select_level'></select><br>";
                $(temp).html(res);
                console.log(temp,res);

                var cont="<option value=''>level</option>";
                for(var i=0; i < level.length; i++){
                    cont += "<option value='"+level[i]+"'>"+level[i]+"</option>";
                }
                $("#list").html(cont);
            
        }
        function del(st_id){
            var bool = confirm("확인버튼을 누르시면 모든 정보가 지워집니다.\n복구할 수 없습니다.");

            if(bool){
                $.ajax({
                url: "delete_student.php",
                type: "get",
                data: {
                    st_id : st_id,
                }
            }).done(function(data) {
                window.location.reload();
            });

            }
        }
    </script>
    <div class='error'>
        <h2>지원하지 않는 화면 크기입니다.</h2>
    </div>
</body>
</html>